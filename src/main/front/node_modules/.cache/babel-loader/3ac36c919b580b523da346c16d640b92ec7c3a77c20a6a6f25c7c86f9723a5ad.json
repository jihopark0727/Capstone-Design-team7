{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\capstone_project\\\\Capstone-Design-team7\\\\src\\\\main\\\\front\\\\src\\\\pages\\\\ClientsPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport SearchBar from '../components/SearchBar';\nimport ClientTable from '../components/ClientTable';\nimport ClientRegistrationForm from '../components/ClientRegistrationForm';\nimport Modal from '../components/ClientRegistrationModal'; // 모달 컴포넌트 추가\nimport './ClientsPage.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ClientsPage() {\n  _s();\n  const [clients, setClients] = useState([]);\n  const [filteredClients, setFilteredClients] = useState([]);\n  const [showRegistrationForm, setShowRegistrationForm] = useState(false);\n\n  // Axios 기본 설정에 Authorization 헤더 추가\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n    } else {\n      delete axios.defaults.headers.common['Authorization'];\n    }\n  }, []);\n\n  // 내담자 데이터 가져오기\n  const fetchClients = async () => {\n    try {\n      const response = await axios.get('/api/clients/assigned-clients');\n      const fetchedClients = response.data.data;\n      setClients(fetchedClients);\n      setFilteredClients(fetchedClients);\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('내담자 데이터를 가져오는 중 오류 발생:', error.response || error.message);\n      alert(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || '내담자 데이터를 가져오는 중 오류가 발생했습니다.');\n    }\n  };\n  useEffect(() => {\n    fetchClients();\n  }, []);\n\n  // 검색 필터 처리\n  const handleSearch = searchTerm => {\n    const filtered = clients.filter(client => Object.values(client).some(value => value === null || value === void 0 ? void 0 : value.toString().toLowerCase().includes(searchTerm.toLowerCase())));\n    setFilteredClients(filtered);\n  };\n\n  // 내담자 등록 처리\n  const handleRegistrationSubmit = async newClient => {\n    try {\n      console.log('Client data being sent:', newClient);\n\n      // API 요청\n      const response = await axios.post('/api/clients', newClient, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      alert('내담자 등록 성공!');\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      console.error('내담자를 등록하는 중 오류 발생:', error.response || error.message);\n      alert(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || '내담자를 등록하는 중 오류가 발생했습니다.');\n    } finally {\n      setShowRegistrationForm(false);\n      fetchClients(); // 등록 후 데이터 다시 가져오기\n    }\n  };\n\n  // 폼 닫기 처리\n  const handleRegistrationCancel = () => {\n    setShowRegistrationForm(false);\n    fetchClients(); // 모달 닫을 때 데이터 다시 가져오기\n  };\n\n  // 내담자 등록 폼 열기\n  const handleAddClient = () => {\n    setShowRegistrationForm(true);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"controls\",\n      children: [/*#__PURE__*/_jsxDEV(SearchBar, {\n        onSearch: handleSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"view-records-button\",\n        onClick: handleAddClient,\n        children: \"\\uB0B4\\uB2F4\\uC790 \\uB4F1\\uB85D\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: showRegistrationForm,\n      onClose: handleRegistrationCancel,\n      children: /*#__PURE__*/_jsxDEV(ClientRegistrationForm, {\n        onSubmit: handleRegistrationSubmit,\n        onCancel: handleRegistrationCancel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ClientTable, {\n      clients: filteredClients\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 9\n  }, this);\n}\n_s(ClientsPage, \"DFw3E2HQ5bX0a0M+a9hk3V5f6Bc=\");\n_c = ClientsPage;\nexport default ClientsPage;\nvar _c;\n$RefreshReg$(_c, \"ClientsPage\");","map":{"version":3,"names":["React","useState","useEffect","axios","SearchBar","ClientTable","ClientRegistrationForm","Modal","jsxDEV","_jsxDEV","ClientsPage","_s","clients","setClients","filteredClients","setFilteredClients","showRegistrationForm","setShowRegistrationForm","token","localStorage","getItem","defaults","headers","common","fetchClients","response","get","fetchedClients","data","error","_error$response","_error$response$data","console","message","alert","handleSearch","searchTerm","filtered","filter","client","Object","values","some","value","toString","toLowerCase","includes","handleRegistrationSubmit","newClient","log","post","Authorization","_error$response2","_error$response2$data","handleRegistrationCancel","handleAddClient","className","children","onSearch","fileName","_jsxFileName","lineNumber","columnNumber","onClick","isOpen","onClose","onSubmit","onCancel","_c","$RefreshReg$"],"sources":["C:/Users/User/capstone_project/Capstone-Design-team7/src/main/front/src/pages/ClientsPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport SearchBar from '../components/SearchBar';\r\nimport ClientTable from '../components/ClientTable';\r\nimport ClientRegistrationForm from '../components/ClientRegistrationForm';\r\nimport Modal from '../components/ClientRegistrationModal'; // 모달 컴포넌트 추가\r\nimport './ClientsPage.css';\r\n\r\nfunction ClientsPage() {\r\n    const [clients, setClients] = useState([]);\r\n    const [filteredClients, setFilteredClients] = useState([]);\r\n    const [showRegistrationForm, setShowRegistrationForm] = useState(false);\r\n\r\n    // Axios 기본 설정에 Authorization 헤더 추가\r\n    useEffect(() => {\r\n        const token = localStorage.getItem('token');\r\n        if (token) {\r\n            axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n        } else {\r\n            delete axios.defaults.headers.common['Authorization'];\r\n        }\r\n    }, []);\r\n\r\n    // 내담자 데이터 가져오기\r\n    const fetchClients = async () => {\r\n        try {\r\n            const response = await axios.get('/api/clients/assigned-clients');\r\n            const fetchedClients = response.data.data;\r\n            setClients(fetchedClients);\r\n            setFilteredClients(fetchedClients);\r\n        } catch (error) {\r\n            console.error('내담자 데이터를 가져오는 중 오류 발생:', error.response || error.message);\r\n            alert(\r\n                error.response?.data?.message || '내담자 데이터를 가져오는 중 오류가 발생했습니다.'\r\n            );\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchClients();\r\n    }, []);\r\n\r\n    // 검색 필터 처리\r\n    const handleSearch = (searchTerm) => {\r\n        const filtered = clients.filter((client) =>\r\n            Object.values(client).some((value) =>\r\n                value?.toString().toLowerCase().includes(searchTerm.toLowerCase())\r\n            )\r\n        );\r\n        setFilteredClients(filtered);\r\n    };\r\n\r\n    // 내담자 등록 처리\r\n    const handleRegistrationSubmit = async (newClient) => {\r\n        try {\r\n            console.log('Client data being sent:', newClient);\r\n\r\n            // API 요청\r\n            const response = await axios.post('/api/clients', newClient, {\r\n                headers: {\r\n                    Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n                },\r\n            });\r\n\r\n            alert('내담자 등록 성공!');\r\n        } catch (error) {\r\n            console.error('내담자를 등록하는 중 오류 발생:', error.response || error.message);\r\n            alert(error.response?.data?.message || '내담자를 등록하는 중 오류가 발생했습니다.');\r\n        } finally {\r\n            setShowRegistrationForm(false);\r\n            fetchClients(); // 등록 후 데이터 다시 가져오기\r\n        }\r\n    };\r\n\r\n    // 폼 닫기 처리\r\n    const handleRegistrationCancel = () => {\r\n        setShowRegistrationForm(false);\r\n        fetchClients(); // 모달 닫을 때 데이터 다시 가져오기\r\n    };\r\n\r\n    // 내담자 등록 폼 열기\r\n    const handleAddClient = () => {\r\n        setShowRegistrationForm(true);\r\n    };\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <div className=\"controls\">\r\n                <SearchBar onSearch={handleSearch} />\r\n                <button className=\"view-records-button\" onClick={handleAddClient}>\r\n                    내담자 등록\r\n                </button>\r\n            </div>\r\n\r\n            {/* 모달로 폼 렌더링 */}\r\n            <Modal isOpen={showRegistrationForm} onClose={handleRegistrationCancel}>\r\n                <ClientRegistrationForm\r\n                    onSubmit={handleRegistrationSubmit}\r\n                    onCancel={handleRegistrationCancel}\r\n                />\r\n            </Modal>\r\n\r\n            <ClientTable clients={filteredClients} />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ClientsPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}